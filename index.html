<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>A Simple Turing Machine Editor</title>
    <link href="tm.css" rel="stylesheet" type="text/css">
    <script src="http://d3js.org/d3.v3.min.js"></script>
    <script>
      var psets = 
        [
          {
            name: "Problem Set 3",
            problems: [
              { name: "1: Bacon ipsum", charSet: "yd", type: "dfa" },
              { name: "2: Dolor amet", charSet: "yd", type: "dfa" },
              { name: "3: Flank meatloaf", charSet: "yd", type: "nfa" }
            ]
          },
          {
            name: "Problem Set 4",
              problems: [
              { name: "1: Short loin", charSet: "abc", type: "dfa" },
              { name: "2: T-bone alcatra", charSet: "abc", type: "dfa" },
              { name: "3: Filet mignon", charSet: "abc", type: "dfa" },
              { name: "4: Beef leberkas", charSet: "01", type: "nfa" },
              { name: "5: Picanha ham", charSet: "01", type: "nfa" },
              { name: "6: Pig shoulder", charSet: "01", type: "nfa" }
            ]
          },
          {
            name: "Problem Set 5",
              problems: [
              { name: "3: Chuck shank", charSet: "0123", type: "turing" },
              { name: "4: Chicken boudin", charSet: "0123", type: "turing" },
              { name: "5: Corned beef", charSet: "0123", type: "turing" }
            ]
          }
        ];
        
      function setup () {
        var psetSelect = d3.select (".pset").selectAll ("option").data (psets);
        psetSelect.enter ()
          .append ("option")
          .attr ("value", function (pset, i) { return i; })
          .each (function (pset, i) { this.innerHTML = pset.name; });
        d3.select ('.pset').node ().selectedIndex = 0;
        changeNumbers ();
      }
        
      function changeNumbers () {
        var psetNum = d3.select ('.pset').node ().selectedIndex;
        
        var problemSelect = d3.select (".problem").selectAll ("option").data (psets[psetNum].problems);
        
        problemSelect.enter ().append ("option");
          
        problemSelect.attr ("value", function (problem) { return problem.charSet; })
          .each (function (problem) { this.innerHTML = problem.name; });
          
        problemSelect.exit ().remove ();
        d3.select ('.problem').node ().selectedIndex = 0;
      }
      
      function createPset () {
        var psetNum = d3.select ('.pset').node ().selectedIndex;
        var problemNum = d3.select ('.problem').node ().selectedIndex;
        var charSet = psets[psetNum].problems[problemNum].charSet;
        var type = psets[psetNum].problems[problemNum].type;
        var url = window.location.href;
        var loc = url.lastIndexOf ("/") + 1;
        if (loc <= 8) {
          url += "/";
        } else {
          url = url.substring (0, loc);
        }
        window.location = url + "tm.html?type=" + type +
                          "&charset=" + charSet +
                          "&pset=" + psetNum +
                          "&problem=" + problemNum;
      }
      
      function createOther () {
        var type = d3.select ('.type').node ().selected;
        var charSet = d3.select ('.language').node ().value;
        var url = window.location.href;
        var loc = url.lastIndexOf ("/") + 1;
        if (loc <= 8) {
          url += "/";
        } else {
          url = url.substring (0, loc);
        }
        window.location = url + "tm.html?type=" + type +
                          "&charset=" + charSet;
      }
        
    </script>
  </head>
  <body onload="setup ()">
    Pick a problem to create a new automata for:
    <div>
      Problem Set: <select class="pset" onchange="changeNumbers ()"></select>
      <br>
      Problem Number: <select class="problem"></select>
      <br>
      <button onclick="createPset ()">Create</button>
    </div>
    <br>
    Or, create an automata with your own settings:
    <div>
      Automata type: 
      <select class="type">
        <option value="dfa">DFA</option>
        <option value="nfa">NFA</option>
        <option value="turing">Turing Machine</option>
      </select>
      <br>
      Language: <input type="text" class="language" value="abcd"></input>
      <br>
      <button onclick="createOther ()">Create</button>
    </div>
  </body>
</html>